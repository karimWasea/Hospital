@{
    ViewData["Title"] = "Save";
    Layout = "_Layout";
}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@addTagHelper *, Cloudscribe.Web.Pagination

@model hospitalVm.ContactVm

<h1>Edit Room</h1>
<partial name="_AlertMessage" />

<form id="saveform">
    <input type="hidden" asp-for="Id" />

    <div class="form-group">
        <label asp-for="Email">RoomName:</label>
        <input asp-for="phone" class="form-control" required />
    </div>

    <label asp-for="hospitalid">Hospital</label>
    <select asp-for="hospitalid" class="form-control" asp-items="@ViewBag.HospitalsId">
        <option value="">Select Hospital</option>
        @foreach (var item in ViewBag.HospitalsId)
        {
            <option value="@item.Value" selected>@item.Text</option>
        }
    </select>

    <button type="button" onclick="saveStudent()" id="savedata" class="btn btn-primary">Save</button>
</form>

<script>
    function saveStudent() {
        var studentForm = document.getElementById("saveform");

        if (studentForm.checkValidity()) {
            Swal.fire({
                title: "Are you sure?",
                text: "You are about to update the room's information.",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Yes, update it!",
                cancelButtonText: "No, cancel",
            }).then((result) => {
                if (result.isConfirmed) {
                    var formData = new FormData(studentForm);

                    fetch("/Admin/Room/Save", {
                        method: "POST",
                        body: formData
                    })
                        .then(response => response.text())
                        .then(response => {
                            Swal.fire({
                                title: "Success!",
                                text: response,
                                icon: "success"
                            });
                        })
                        .catch(error => {
                            console.error("Error:", error);
                            Swal.fire({
                                title: "Error!",
                                text: "An error occurred while saving the data.",
                                icon: "error"
                            });
                        });
                }
            });
        } else {
            studentForm.reportValidity();
        }
    }
</script>
